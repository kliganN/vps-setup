# VPS Setup Playbook

Данный Ansible плейбук предназначен для автоматизации стандартной настройки арендованного VPS сервера на базе Linux.

## Содержание

- [Требования](#требования)
- [Описание ролей](#описание-ролей)
- [Параметры](#параметры)
- [Использование](#использование)

## Требования

- Ansible 2.9 или выше
- Наличие арендованного VPS сервера с установленным Linux (установка тестировалась на Debian и Ubuntu)

## Описание ролей

1. Обновление и кэширование APT репозиториев
2. Добавление пользователя `admin` в систему и в группу `sudo`
3. Установка правила для группы `sudo`, позволяющего выполнять команды без пароля
4. Применение `umask 0077` для файла `.bashrc` пользователя `admin`
5. Установка основных пакетов: `git`, `ufw`, `nmap`, `net-tools`, `curl`
6. Изменение настроек SSH: изменение порта на `2207`
7. Перезапуск сервиса SSH

## Параметры

- `cache_valid_time`: Время валидации кэша APT (по умолчанию: `7200`)
- `password`: Пароль добавляемого пользователя `admin` (по умолчанию: `ur_password` требуется, заменить на Ваш. см. ключевые моменты)

## Использование

1. Создайте свой инвентарный файл на основе примера:

```ini
[vps]
your_vps_ip ansible_user=root ansible_ssh_pass=your_root_password
```

Замените `your_vps_ip` и `your_root_password` на актуальные данные вашего сервера.

2. Замените на свой пароль в файле vps-setup.yml:

```yaml
---
- name: Add user to system and sudoers
  user:
    name: admin
    password: "{{ 'YOUR_PASSWORD' | password_hash('sha512') }}"
```

3. Запустите плейбук с указанием инвентарного файла:

```bash
ansible-playbook -i hosts.ini vps-setup.yml
```

После выполнения плейбука ваш VPS сервер будет настроен согласно описанным ролям.

## Ключевые моменты
- Пароль по умолчанию для создаваемого пользователя небезопасен, поскольку он открыто указан в коде. Рекомендуется изменить пароль на собственный безопасный пароль перед использованием плейбука или использовать Ansible Vault для шифрования пароля.
- Обязательно измените по умолчанию переменные, такие как пароль или порт, для большей безопасности вашего сервера.
